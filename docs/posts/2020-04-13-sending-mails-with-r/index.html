<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>R &amp; flowers (o casi): Sending mails with R</title>

<meta property="description" itemprop="description" content="Cómo mandar mails con `gmailr`.   &#10;Repaso de otros paquetes para mandar mails con R."/>

<link rel="canonical" href="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/png" href="../../imagenes/favicon.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-04-13"/>
<meta property="article:created" itemprop="dateCreated" content="2020-04-13"/>
<meta name="article:author" content="Pedro J. Pérez"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="R &amp; flowers (o casi): Sending mails with R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Cómo mandar mails con `gmailr`.   &#10;Repaso de otros paquetes para mandar mails con R."/>
<meta property="og:url" content="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"/>
<meta property="og:image" content="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/imagenes/foto-post-gmail.jpg"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="R &amp; flowers (o casi)"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="R &amp; flowers (o casi): Sending mails with R"/>
<meta property="twitter:description" content="Cómo mandar mails con `gmailr`.   &#10;Repaso de otros paquetes para mandar mails con R."/>
<meta property="twitter:url" content="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"/>
<meta property="twitter:image" content="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/imagenes/foto-post-gmail.jpg"/>
<meta property="twitter:site" content="@pjpv4444"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="R &amp; flowers (o casi): Sending mails with R"/>
<meta name="citation_fulltext_html_url" content="https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2020/04/13"/>
<meta name="citation_publication_date" content="2020/04/13"/>
<meta name="citation_author" content="Pedro J. Pérez"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","categories","draft","base_url","preview","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Sending mails with R"]},{"type":"character","attributes":{},"value":["Cómo mandar mails con `gmailr`.   \nRepaso de otros paquetes para mandar mails con R."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Pedro J. Pérez"]}]}]},{"type":"character","attributes":{},"value":["04-13-2020"]},{"type":"character","attributes":{},"value":["R","mail","Google"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["https://perezp44.github.io/my_blog_R-flowers-0.1.3/docs"]},{"type":"character","attributes":{},"value":["imagenes/foto-post-gmail.jpg"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"]},{"type":"character","attributes":{},"value":["https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["imagenes/01_AI-ML-DL.png","imagenes/foto-post-gmail.jpg","sending-mails-with-r_files/bowser-1.9.3/bowser.min.js","sending-mails-with-r_files/distill-2.2.21/template.v2.js","sending-mails-with-r_files/jquery-1.11.3/jquery.min.js","sending-mails-with-r_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative;}
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<style type="text/css">

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Sending mails with R","description":"Cómo mandar mails con `gmailr`.   \nRepaso de otros paquetes para mandar mails con R.","authors":[{"author":"Pedro J. Pérez","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2020-04-13T00:00:00.000+02:00","citationText":"Pérez, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../imagenes/flor.jpg"/>
</a>
<a href="../../index.html" class="title">R &amp; flowers (o casi)</a>
<a href="../../index.html">
<i class="fa fa-home"></i>
</a>
</div>
<div class="nav-right">
<a href="../../distill-blog.html">Blog</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Tutoriales
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../tt_gestionar-distill-blog.html">Gestionar un Distill blog</a>
<a href="../../tt_06.html">ggplot2</a>
</div>
</div>
<a href="../../about.html">About</a>
<a href="https://github.com/perezp44/my_distill_web-blog">
<i class="fab fa-github"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Sending mails with R</h1>
<p>Cómo mandar mails con <code>gmailr</code>.<br />
Repaso de otros paquetes para mandar mails con R.</p>
</div>

<div class="d-byline">
  Pedro J. Pérez  
  
<br/>04-13-2020
</div>

<div class="d-article">
<h3 class="d-toc-header">Table of Contents</h3>
<nav class="d-toc" id="TOC">
<ul>
<li><a href="#intro">0. Intro</a></li>
<li><a href="#cómo-mandar-mails-con-gmailr">1. Cómo mandar mails con <code>gmailR</code>?</a><ul>
<li><a href="#cargar-el-listado-de-estudiantesmails">1.2 Cargar el listado de estudiantes/mails</a></li>
<li><a href="#mándando-los-mails">1.3 Mándando los mails</a></li>
</ul></li>
<li><a href="#probando-con-otros-paquetes">2. Probando con otros paquetes</a><ul>
<li><a href="#mailr">2.1 <code>mailR</code></a></li>
<li><a href="#emayili">2.2 <code>emayili</code></a></li>
<li><a href="#ponyexpress">2.3 <code>ponyexpress</code></a></li>
<li><a href="#blastula">2.4 <code>blastula</code></a></li>
</ul></li>
<li><a href="#biblio">Biblio</a></li>
</ul>
</nav>
<hr class="d-toc-separator"/>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="/home/pjpv/Escritorio/my_blog_R-flowers-0.1.3/imagenes/foto-post-gmail.jpg" width="10%" style="display: block; margin: auto;" /></p>
</div>
<h2 id="intro">0. Intro</h2>
<p>Estamos confinados en casa por el covid-19 y estamos viendo como examinamos a nuestros estudiantes. Parece que los exámenes serán online, así que me he puesto a recordar como puedo enviar e-mails con R.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
knitr::include_graphics(here::here(&quot;imagenes&quot;, &quot;01_AI-ML-DL.png&quot;))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="/home/pjpv/Escritorio/my_blog_R-flowers-0.1.3/imagenes/01_AI-ML-DL.png" alt="IA, ML y DL" width="75%" />
<p class="caption">
Figure 1: IA, ML y DL
</p>
</div>
</div>
<p>Cuando mandaba mails con R usaba <a href="https://rpremraj.github.io/mailR/"><code>mailR</code></a> y funcionaba bastante bien, pero necesita la versión de Java 8.0 de Oracle. Ahora trabajo en un ordenador con Ubuntu y no quiero cambiar a Java 8.0, así que tendré que cambiar de método. La verdad es que en R hay unos cuantos paquetes para mandar mails, algunos de ellos los repasan en <a href="https://blog.mailtrap.io/r-send-email/">este post</a>.</p>
<p>Trasteé un poco con varios paquetes, pero siempre tenía problemas con la autentificación en el servidor de la UV,incluso me planteé hacerlo con Phyton y medio leí <a href="https://realpython.com/python-send-email/#option-1-setting-up-a-gmail-account-for-development" target="_blank">este tutorial</a>, pero al final parece que seguiŕe en R y mandaré los mails con <a href="https://gmailr.r-lib.org/"><code>gmailr</code></a>, tal y como hace (o hacía) mi heRoine Jenny. Jenny nos cuenta como hace ella para mandar mails <a href="https://github.com/jennybc/send-email-with-r">aquí</a>.</p>
<p>Al usar el paquete <code>gmailr</code> tendré que usar una cuenta de Gmail y además, la cuenta tiene que poder ser accedida por apps “sospechosas” o no verificadas. Por ello, me he creado una cuenta de Gmail lo más parecida a mi cuenta de la UV. Esta es: <code>pedro.j.perez.uv.es@gmail.com</code>.</p>
<p>Lo más fastidiado es configurar el acceso a la cuenta de Gmail. He hecho caso al <a href="https://github.com/jennybc/send-email-with-r">tutorial de Jenny</a>, y a pesar de estar un poco desactualizado, no me ha hecho falta mirar la web de <code>gmailR</code>. Entre que estaban un poco anticuadas las instrucciones y que, la verdad, no se mucho sobre como funcionan las APis de Google, pues lo he hecho por prueba y error. Lo que recuerdo que he hecho es: 1) he creado un pryecto en the <code>Google Developers Console</code>. Al proyecto lo he llamado <code>mandar-mails-pjp</code>. 2) En ese proyecto he habilitado la <code>Gmail API</code>. 3) He creado unas credenciales. Se supone que las credenciales tenía que almacenarlas en un archivo .json para luego usarlas, pero asi no me ha funcionado. He puesto a mano el Client ID y el Client Secret y así sí me ha funcionado. Ya he conseguido mandar mails!!!</p>
<h2 id="cómo-mandar-mails-con-gmailr">1. Cómo mandar mails con <code>gmailR</code>?</h2>
<p>Voy a dividir el proceso en 3 partes:</p>
<ul>
<li><p>Configurar la cuenta de Gmail. Ya he hablado arriba sobre ello. Tienes que crear una cuenta Gmail. Crear un proyecto. Habilitar la Gmail API y crear unas credenciales. Buff!! la verdad es que suena complicado pero me ha salido rapidito con la ayuda del tutorial de Jenny.</p></li>
<li><p>Cargar el listado de estudiantes: su nombre y apellidos, e-mail, informacion y posiblemnet su pdf con su examen. Easy-pesy</p></li>
<li><p>Enviar los e-mails. Támbien muy fácil</p></li>
</ul>
<h3 id="cargar-el-listado-de-estudiantesmails">1.2 Cargar el listado de estudiantes/mails</h3>
<p>Logicamente hay que tener un listado de gente/estudiantes a los que mandar el mail.</p>
<p>En Aula Virtual te vas al curso al que quieres mandar el email y vas al apartado <code>Fitxes</code>. Allí, en la caja <code>Informe del calificador</code> seleccionas <code>Exportar, como hoja de calculo</code> y consigues bajarte un archivo con los nombres, e-mails y NPA.</p>
<p>Una vez tienes el archivo con los datos, has de abrirlo con R. El chunk de abajo genera un listado de archivos en la carpeta donde guardas el listadoy luego selecciona el archivo concreto que quieres usar:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
folder &lt;- here::here(&quot;datos&quot;, &quot;para-post-mandar-mails&quot;)   #- AQUI-AQUI: carpeta donde está el archivo con el listado de e-mails 
lista_archivos &lt;- fs::dir_ls(folder)
my_listado &lt;- lista_archivos[2]                           #- AQUI-AQUI elegir el archivo donde está el listado de e-mails</code></pre>
</div>
<p>Arreglo un poco los nombres de las columnas:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
archivo_emails &lt;- rio::import(my_listado)      #- readODS::read_ods(archivo, my_sheet)
df &lt;- archivo_emails
df &lt;- janitor::clean_names(df)  #- limpia los nombres
df &lt;- df %&gt;% rename(NPA = numero_de_id) %&gt;% rename(email = direccion_de_correo) %&gt;% rename(apellidos = apellido_s)
nn_estudiantes &lt;- nrow(df)  </code></pre>
</div>
<p>Si en el fichero hubiese añadidos las notas para mandarselas, podrías filtrar a los no presentados etc….</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
df &lt;- df %&gt;% filter(ACTAS != &quot;NP&quot;)  #- quitar NO PRESENTADOS
df &lt;- df %&gt;% mutate(NOTA_FINAL = as.numeric(NOTA_FINAL)) %&gt;% pjpv2020.01::pjp_f_decimales() #- pongo 2 decimales
nn_estudiantes &lt;- nrow(df)</code></pre>
</div>
<p>Los examenes los tendré en otra carpeta. Aquí obtengo un listado de los archivos/exámenes a mandar.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
folder_examenes &lt;- here::here(&quot;datos&quot;, &quot;para-post-mandar-mails&quot;, &quot;examenes&quot;)          #- carpeta donde está el archivo con los examenes
lista_examenes &lt;- fs::dir_ls(folder_examenes)</code></pre>
</div>
<p>Un ejemplo del texto que quiero mandarles:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
my_subject &lt;- &quot;Notas finales&quot;
ii &lt;- 3   #- voy a seleccionar un student para probar
my_body &lt;- glue::glue(&quot;Hola {df$nombre[ii]} (con NPA:{df$NPA[ii]} ), \n&quot;,  &quot;\n&quot;,
                &quot;te informo de que tu nota en el examen final de la asignatura Econometría es un &quot;,
                {df$NPA[ii]}, &quot; (el examen se puntua sobre 10 puntos).\n &quot;,  &quot;\n&quot;,
                &quot;Como el examen final supone el 70% de la nota de la asignatura, tu nota en el examen aporta &quot;, {df$NPA[ii]},
                &quot; puntos a tu nota final en la asignatura&quot;,
                &quot; ; por lo tanto, tu nota final en la asignatura que aparacerá en ACTAS (una vez sumada los puntos de la evaluación continua) es: &quot;,
                {df$NPA[ii]} , &quot;\n&quot;,  &quot;\n&quot;,
                &quot;Saludos&quot;)</code></pre>
</div>
<h3 id="mándando-los-mails">1.3 Mándando los mails</h3>
<p>Una vez tengo el listado, queda mandar los mails. Pero antes hay que configurar las credenciales. Esto <strong>SÍ</strong> me ha funcionado:</p>
<p>Recuerda que las keys y demas está en el Rproject <code>my_escribir-posts_2020</code></p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
gmailr::gm_auth_configure(key = &quot;xxxxx&quot;, secret = &quot;xxxxx&quot;, appname = &quot;mandar-mails-pjp&quot;)</code></pre>
</div>
<p>Esto no me funcionó</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
gmailr::use_secret_file(&quot;mandar-mails-pjp.json&quot;) #- no me ha funcionado</code></pre>
</div>
<p>Esto tampoco me funcionó</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
google_app &lt;- httr::oauth_app(&quot;mandar-mails-pjp.json&quot;, key = &quot;xxxx&quot;, secret = &quot;xxxx&quot;)
gmailr::gm_auth_configure(app = google_app)</code></pre>
</div>
<p>El caso es que una vez has configura el acceso con el key y el secret, tenemos que mandar efectivamente los mails. Para crear el mail has de:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(tidyverse)
library(gmailr)
test_email &lt;- gm_mime() %&gt;% gm_to(&quot;pedro.j.perez@uv.es&quot;) %&gt;%
                            gm_from(&quot;pedro.j.perez.uv.es@gmail.com&quot;) %&gt;%
                            gm_subject(&quot;This is just a gmailr test&quot;) %&gt;%
                            gm_text_body(&quot;Tet, can you hear me now?&quot;)</code></pre>
</div>
<p>Una vez creado el mail, puedes crear un borrador con</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
gmailr::gm_create_draft(test_email) </code></pre>
</div>
<p>O directamente mandar el mail asín:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
gmailr::gm_send_mssage(test_email)</code></pre>
</div>
<p>OK. Todo chuta. Generalmente mando los mails usando un <code>for</code> loop.Sería algo como… No mires Hadley!!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
sending.email &lt;- &quot;pedro.j.perez.uv.es@gmail.com&quot;   #- cuenta desde la q mando los emails
for (ii in 1:4) {
  my_subject &lt;- &quot;Notas finales&quot;
  email.destino &lt;- df$email[ii]
  my_body &lt;- glue::glue(&quot;Hola {df$nombre[ii]} (con NPA:{df$NPA[ii]} ), \n&quot;,  &quot;\n&quot;,
                &quot;te informo de que tu nota en el examen final de la asignatura Econometría es un &quot;,
                {df$NPA[ii]}, &quot; (el examen se puntua sobre 10 puntos).\n &quot;,  &quot;\n&quot;,
                &quot;Como el examen final supone el 70% de la nota de la asignatura, tu nota en el examen aporta &quot;, {df$NPA[ii]},
                &quot; puntos a tu nota final en la asignatura&quot;,
                &quot; ; por lo tanto, tu nota final en la asignatura que aparacerá en ACTAS (una vez sumada los puntos de la evaluación continua) es: &quot;,
                {df$NPA[ii]} , &quot;\n&quot;,  &quot;\n&quot;,
                &quot;Saludos&quot;)

test_email &lt;- gm_mime() %&gt;% gm_to(email.destino)   %&gt;%   #- creando el mail
                            gm_from(sending.email) %&gt;%
                            gm_subject(my_subject) %&gt;%
                            gm_text_body(my_body)

gm_send_message(test_email)  #- sending the email

  if(ii%%15 == 0) {
            cat(ii, &#39;waiting for a while...&#39;)
            Sys.sleep(300)
          }
}</code></pre>
</div>
<h2 id="probando-con-otros-paquetes">2. Probando con otros paquetes</h2>
<h3 id="mailr">2.1 <code>mailR</code></h3>
<p>Este paquete es el que usaba, pero suele dar problemas con la configuración de <code>rjava</code>. En este tutorial explican como funciona: <a href="https://github.com/rpremraj/mailR" class="uri">https://github.com/rpremraj/mailR</a></p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
#- install.packages(&quot;rJava&quot;,&quot;http://rforge.net&quot;) #- volvi a instalar rjava
#for (ii in 1:nn_estudiantes) {
for (ii in 3:3) {
  email.destino &lt;- df$email[ii]
  my_body &lt;- glue::glue(&quot;Hola {df$nombre[ii]} (con NPA:{df$NPA[ii]} ), \n&quot;,  &quot;\n&quot;,
                &quot;te informo de que tu nota en el examen final de la asignatura Econometría es un &quot;,
                {df$NPA[ii]}, &quot; (el examen se puntua sobre 10 puntos).\n &quot;,  &quot;\n&quot;,
                &quot;Como el examen final supone el 70% de la nota de la asignatura, tu nota en el examen aporta &quot;, {df$NPA[ii]},
                &quot; puntos a tu nota final en la asignatura&quot;,
                &quot; ; por lo tanto, tu nota final en la asignatura que aparacerá en ACTAS (una vez sumada los puntos de la evaluación continua) es: &quot;,
                {df$NPA[ii]} , &quot;\n&quot;,  &quot;\n&quot;,
                &quot;Saludos&quot;)

    #ruta_al_attach &lt;- paste0(here::here(), &quot;/datos/mail_con_r.txt&quot;)
    send.mail(from = &quot;pjperez@uv.es&quot;,
            to = c(toString(email.destino)),
            subject = my_subject,
            body = my_body,
            #attach.files = ruta_al_attach,
            encoding = &quot;utf-8&quot;,
            html = TRUE,
            smtp = list(host.name = &quot;post.uv.es&quot;, port = 25, user.name = &quot;pjperez&quot;, passwd = my_password, ssl = TRUE),
            authenticate = TRUE,
            send = TRUE, debug = TRUE )

   #- antes ponia el puertp 465
print(email.destino)
     if(ii%%15 == 0) {
            cat(ii, &#39;waiting for a while...&#39;)
           Sys.sleep(300)
          }
}
</code></pre>
</div>
<p>Pero no funciona, de hecho, ni siquiera he podido instalar <code>rJava</code>. Tampoco lo he intentando mucho. Estoy hartito de rJava!!!</p>
<p>Los mensajes que me da son:</p>
<pre><code>
# no funciona: Error in .jnew(&quot;org.apache.commons.mail.HtmlEmail&quot;) :java.lang.NoClassDefFoundError: javax/activation/DataSource
#- asi que me instale la version de github y tampoco: remotes::install_github(&quot;rpremraj/mailR&quot;)
#- en las issues de Github un tio dice que se puede hacer un workaround: https://github.com/rpremraj/mailR/issues/77#issuecomment-452923526</code></pre>
<h3 id="emayili">2.2 <code>emayili</code></h3>
<p>El paquete <a href="https://datawookie.netlify.com/blog/2019/05/emayili-sending-email-from-r/"><code>emayili</code></a> tampoco me acabó de funcionar</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
#- remotes::install_github(&quot;datawookie/emayili&quot;)
#- seguramente no me dejará x STARTTLS security protocol (like Google Mail, Yahoo! or AOL), then it will most probably be blocked due to insufficient security. 
library(emayili)
vignette(package = &quot;emayili&quot;)  #- no hay
email &lt;- envelope() %&gt;%
  from(&quot;pedro.j.perez.uv.es@gmail.com&quot;) %&gt;%
  to(&quot;pjperez@uv.es&quot;) %&gt;%
  subject(my_subject) %&gt;% text(&quot;Hola&quot;)
  emayili::text(my_body)

smtp &lt;- server(host = &quot;smtp.gmail.com&quot;, port = 465,
               username = &quot;pedro.j.perez.uv.es@gmail.com&quot;,
               password = my_password)
smtp &lt;- server(host = &quot;post.uv.es&quot;, port = 587, insecure = TRUE,
               username = &quot;pjperez&quot;, password = my_password)
smtp(email, verbose = TRUE)</code></pre>
</div>
<h3 id="ponyexpress">2.3 <code>ponyexpress</code></h3>
<p>Ponyexpress: <a href="https://github.com/ropenscilabs/ponyexpress" class="uri">https://github.com/ropenscilabs/ponyexpress</a>. Sí me funciona pero me quedo con <code>gmailR</code></p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
#- remotes::install_github(&quot;ropenscilabs/ponyexpress&quot;)
library(ponyexpress)
vignette(package = &quot;ponyexpress&quot;)  #- no hay
df &lt;- data.frame(name = c(&quot;Lucy&quot;, &quot;Karthik&quot;),
                 email = c(&quot;pedro.j.perez@uv.es&quot;, &quot;pjperez@uv.es&quot;))
template &lt;- &quot;Dear {name},   This is a friendly email from me.  XO,   Lucy&quot;
parcel &lt;- parcel_create(df, sender_name = &quot;Pedrote&quot;,
                        sender_email = &quot;pedro.j.perez.uv.es@gmail.com&quot;,
                        subject = my_subject,
                        template = template)
parcel_preview(parcel)
parcel_send(parcel)</code></pre>
</div>
<h3 id="blastula">2.4 <code>blastula</code></h3>
<p>Lo usan <a href="https://solutions.rstudio.com/2019/12/30/rstudio-connect-custom-emails-with-blastula/">aquí</a> con Rconnect. No lo he leido del todo pero como que parece que puede ser el futuro. No se. A mi no me ha funcionado porque me hace falta habilitar keyring en Ubuntu</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(blastula)
email &lt;-  compose_email(body = my_body)

smtp_send(email = email,  from = &quot;pedro.j.perez.uv.es@gmail.com&quot;,
  to = &quot;pjperez@uv.es&quot;,
  credentials = creds(host = &quot;smtp.gmail.com&quot;, port = 25, user = &quot;pedro.j.perez.uv.es&quot;, use_ssl = FALSE)
)

#- pide la clave pero no permite autentificar
create_smtp_creds_key(
  id = &quot;uv_creds&quot;,
  provider = &quot;gmail&quot;,
  user = &quot;pedro.j.perez.uv.es&quot;,
  host = &quot;smtp.gmail.com&quot;,
  port = 587,
  use_ssl = TRUE  )
creds_file()
create_smtp_creds_key()</code></pre>
</div>
<h2 id="biblio">Biblio</h2>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/perezp44/my_blog_R-flowers-0.1.3/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/perezp44/my_blog_R-flowers-0.1.3">https://github.com/perezp44/my_blog_R-flowers-0.1.3</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Pérez (2020, April 13). R &amp; flowers (o casi): Sending mails with R. Retrieved from https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{pérez2020sending,
  author = {Pérez, Pedro J.},
  title = {R &amp; flowers (o casi): Sending mails with R},
  url = {https://perezp44.github.io/my_blog_R-flowers-0.1.3/posts/2020-04-13-sending-mails-with-r/},
  year = {2020}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
